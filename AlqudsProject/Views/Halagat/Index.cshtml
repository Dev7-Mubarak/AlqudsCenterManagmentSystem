<head>
    <link rel="stylesheet" href="~/css/halagatIndexStyle.css" asp-append-version="true" />
</head>

@model IEnumerable<AlqudsProject.Models.Halaqa>

@{
    ViewData["Title"] = "قائمة الحلقات";
}

<h2>@ViewData["Title"]</h2>

<form method="get" asp-action="Index" class="filters-container mb-4">
    <div>
        <a class="add-btn" asp-action="Create">➕ إضافة حلقة جديدة</a>
    </div>
    <div>
        <input type="text" id="searchInput" class="form-control" placeholder="بحث باسم الحلقة أو المعلمة ..." />
    </div>
</form>

<div class="row row-cols-1 row-cols-md-3 g-4" id="halaqatContainer">
    @foreach (var item in Model)
    {
        <div class="col halaqa-card">
            <div class="card">
                <div class="row g-0">
                    <div class="col-md-4">
                        <img src="~/images/cardbg1.jpg" class="img-fluid" alt="صورة الحلقة">
                    </div>
                    <div class="col-md-8">
                        <div class="card-body">
                            <h5 class="card-title">حلقة @item.Name</h5>
                            <p class="card-text"><strong>المعلمة:</strong> @item.Teacher?.Name</p>
                            <p class="card-text"><strong>السنة الدراسية:</strong> @item.AcademicYear?.AcademicYear1</p>
                            <div class="d-flex justify-content-end">
                                <a asp-action="Details" asp-route-id="@item.HalaqaId" class="btn-sm btn-my-1"><i class="bi bi-eye"></i></a>
                                <a asp-action="Edit" asp-route-id="@item.HalaqaId" class="btn-sm btn-my-1"><i class="bi bi-pencil"></i></a>
                                <a asp-action="Delete" asp-route-id="@item.HalaqaId" class="btn-sm btn-my-2"><i class="bi bi-trash3-fill"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div> 
        </div>
    }
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $("#searchInput").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            var hasResult = false;
            $(".halaqa-card").each(function () {
                var text = $(this).text().toLowerCase();
                var match = text.indexOf(value) > -1;
                $(this).toggle(match);
                if (match) hasResult = true;
            });

            if (!hasResult) {
                if ($("#noResults").length === 0) {
                    $("#halaqatContainer").append("<div id='noResults' class='col'><div class='alert alert-warning text-center'>لا توجد نتائج مطابقة</div></div>");
                }
            } else {
                $("#noResults").remove();
            }
        });
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
